# Fail2Ban filter for credential/config file harvesting attempts
# Catches probing for .env, .git, backup files, config leaks
# These are clearly malicious - ban aggressively

[Definition]

failregex = ^<HOST> \- \S+ \[\] \"(GET|POST|HEAD) /[^\"]*\.(env|git|svn|htaccess|htpasswd|npmrc|dockerenv)[^\"]*\s+\S+\" \d+ \d+ \"[^\"]*\" \".*\"$
            ^<HOST> \- \S+ \[\] \"(GET|POST|HEAD) /[^\"]*\.(env\.\w+|env\.bak|env\.backup|env\.local|env\.dev|env\.prod)[^\"]*\s+\S+\" \d+ \d+ \"[^\"]*\" \".*\"$
            ^<HOST> \- \S+ \[\] \"(GET|POST|HEAD) /[^\"]*\.git/(config|HEAD|refs|objects|index|logs)[^\"]*\s+\S+\" \d+ \d+ \"[^\"]*\" \".*\"$
            ^<HOST> \- \S+ \[\] \"(GET|POST|HEAD) /[^\"]*config\.env[^\"]*\s+\S+\" \d+ \d+ \"[^\"]*\" \".*\"$

ignoreregex =
