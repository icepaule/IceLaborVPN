# Fail2Ban filter for nginx port/vulnerability scanning
# Catches nmap probes, vulnerability scanners, and suspicious 404/400 floods

[Definition]

failregex = ^<HOST> \- \S+ \[\] \"(GET|POST|HEAD|PUT|DELETE|OPTIONS|PATCH|PROPFIND) \S+ \S+\" (400|404|405|444) \d+ \"[^\"]*\" \".*\"$

ignoreregex = ^<HOST> .* \"GET /favicon\.ico
              ^<HOST> .* \"GET /robots\.txt
